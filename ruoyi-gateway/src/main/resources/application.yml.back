# Tomcat
server:
  port: 8080
  servlet:
    context-path: /

# Spring
spring:
  application:
    # 应用名称
    name: ruoyi-gateway
  profiles:
    # 环境配置
    active: dev

  cloud:
    nacos:
      server-addr: 139.196.208.53:8848
      discovery:
        namespace: ${spring.profiles.active}
        username: nacos
        password: nacos

    # sentinel 配置
    sentinel:
      # Sentinel 网关流控默认的粒度是 route 维度以及自定义 API 分组维度，默认不支持 URL 粒度。
      # 若通过 Spring Cloud Alibaba 接入，请将 spring.cloud.sentinel.filter.enabled 配置项置为 false
      #（若在网关流控控制台上看到了 URL 资源，就是此配置项没有置为 false）
      filter:
        enabled: false

    # 网关配置
    gateway:
      # 打印请求日志(自定义)
      requestLog: true
      # 默认filter添加请求头参数
      default-filters:
        - AddRequestHeader=origin,gateway
      discovery:
        locator:
          lowerCaseServiceId: true
          enabled: true
      routes:
        # 认证中心
        - id: ruoyi-auth
          uri: lb://ruoyi-auth
          predicates:
            - Path=/auth/**
          filters:
            - StripPrefix=1
        # 代码生成
        - id: ruoyi-gen
          uri: lb://ruoyi-gen
          predicates:
            - Path=/tool/**
          filters:
            - StripPrefix=1
        # 系统模块
        - id: ruoyi-system
          uri: lb://ruoyi-system
          predicates:
            - Path=/system/**,/monitor/**
          filters:
            - StripPrefix=1
        # 资源服务
        - id: ruoyi-resource
          uri: lb://ruoyi-resource
          predicates:
            - Path=/resource/**
          filters:
            - StripPrefix=1
        # 演示服务
        - id: ruoyi-demo
          uri: lb://ruoyi-demo
          predicates:
            - Path=/demo/**
          filters:
            - StripPrefix=1

# 安全配置
security:
  # 防止XSS攻击
  xss:
    enabled: true
    excludeUrls:
      - /system/notice
  # 不校验白名单
  ignore:
    whites:
      - /auth/code
      - /auth/logout
      - /auth/login
      - /auth/binding/*
      - /auth/social/callback
      - /auth/register
      - /auth/tenant/list
      - /auth/slider/captcha/**
      - /resource/sms/code/*
      - /resource/email/code/*
      - /*/error
      - /*/actuator/**
      - /csrf
      - /doc.html
      - /*/v3/api-docs
      - /v3/api-docs/**

knife4j:
  gateway:
    enabled: true
    # order-Knife4j提供的增强排序规则，开发者可扩展x-order，根据数值来自定义排序
    tags-sorter: order
    operations-sorter: order
    # 指定手动配置的模式(默认为该模式)
    strategy: manual
    routes:
      - name: 系统服务
        url: /system/v3/api-docs
        order: 1
      - name: 认证服务
        url: /auth/v3/api-docs
        order: 2
      - name: 资源服务
        url: /resource/v3/api-docs
        order: 3
      - name: 演示服务
        url: /demo/v3/api-docs
        order: 4

